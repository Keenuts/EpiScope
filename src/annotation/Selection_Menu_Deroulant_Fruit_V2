import tkinter as tk
import os

class MenuDeroulant(tk.Tk):
    def __init__(self):
        super().__init__()
        self.title("Menu Déroulant")
        self.geometry('600x400')

        self.labelChoix = tk.Label(self, text="Veuillez faire un choix !")
        self.labelChoix.grid()

        # Stocker la dernière valeur sélectionnée
        self.Liste_var_selected = []
        self.previous_selections = []

        self.create_dropdown_menus()

        # Créer la fenêtre pour afficher les symptômes
        self.symptomes_window = tk.Toplevel(self)
        self.symptomes_window.title("Symptômes sélectionnés")
        self.symptomes_window.geometry('400x300')

        # Zone de texte pour afficher les symptômes
        self.symptomes_text = tk.Text(self.symptomes_window, height=10, width=40, relief=tk.GROOVE, wrap=tk.WORD)
        self.symptomes_text.pack(pady=10)

    def create_dropdown_menus(self):
        Liste = []

        # Nom du fichier contenant la liste des fruits regroupés par catégorie
        script_directory = os.path.dirname(os.path.abspath(__file__))
        Monfichier = os.path.join(script_directory, "Liste_Fruits.txt")

        # Création des differents menus déroulants
        with open(Monfichier, 'r') as file:
            for line in file:
                line = line.strip()
                Liste = line.split(';')

                var_selected = tk.StringVar()
                var_selected.set(Liste[0])
                self.Liste_var_selected.append(var_selected)

                Liste = Liste[1:]
                MenuDeroulant = tk.OptionMenu(self, var_selected, *Liste)
                MenuDeroulant.grid(row=len(self.Liste_var_selected) * 10, sticky="nsew", padx=5, pady=5)

                # Configuration de la fonction appelée lorsqu'une option est sélectionnée
                var_selected.trace_add('write', lambda *args, var=var_selected: self.on_select(var))

    def on_select(self, var_selected):
        symptome = var_selected.get()
        self.previous_selections.append(symptome)

        # Met à jour le contenu de la zone de texte des symptômes
        self.symptomes_text.config(state=tk.NORMAL)  # Active la modification
        self.symptomes_text.insert(tk.END, symptome + "\n")
        self.symptomes_text.config(state=tk.DISABLED)

if __name__ == "__main__":
    app = MenuDeroulant()
    app.mainloop()
