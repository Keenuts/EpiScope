import tkinter as tk
from tkinter import ttk
import os


maFenêtre = tk.Tk() 
maFenêtre.title("Menu Déroulant")
maFenêtre.geometry('600x400')

labelChoix = tk.Label(maFenêtre, text = "Veuillez faire un choix !")
labelChoix.grid()

def on_select():
    selected_value = [Liste_var_selected]
    previous_selections.append(selected_value)
    
    # Met à jour le contenu du Text avec les sélections précédentes et la sélection actuelle
    text_output.config(state=tk.NORMAL)  # Active la modification
    text_output.delete(1.0, tk.END)
    text_output.insert(tk.END, '\n'.join(previous_selections))
    text_output.config(state=tk.DISABLED)
    scrollbar.set(0.0, tk.END)  # Fait défiler la barre de défilement vers le bas


Liste = []
i=15   # Ligne d'affichage du premier menu déroualant 
Liste_var_selected = []


# 1) Nom du fichier contenant la liste des fruits regroupés par catégorie
script_directory = os.path.dirname(os.path.abspath(__file__))
Monfichier = os.path.join(script_directory,"Liste_Fruits.txt")


# 2) Création des differents menus déroualant

with open(Monfichier, 'r') as file :       # Ouverture du fichier en lecture seule
    for line in file :
        line = line.strip()             # Supprime les espaces inutiles
        Liste = line.split(';')         # Indique que le point-virgule est l'outil de séparation des éléments dans chaque ligne du fichier

        var_selected = tk.StringVar()
        var_selected.set(Liste[0])      # Place le premier élément de la liste en option par défaut du menu (titre)
        Liste_var_selected.append(var_selected)
        
        Liste = Liste[1:]
        MenuDeroulant = tk.OptionMenu(maFenêtre, var_selected, *Liste)      # Création du menu déroulant
        MenuDeroulant.grid(row=i, sticky="nsew", padx=5, pady=5)        # Positionnement du menu déroulant dans la fénêtre
        i+=10



# Création du Text (zone de texte en lecture seule)
text_output = tk.Text(maFenêtre, height=10, width=30, relief=tk.GROOVE, wrap=tk.WORD, state=tk.DISABLED)
text_output.grid(row=20, column=160, pady=10)

# Barre de défilement
scrollbar = ttk.Scrollbar(maFenêtre, orient=tk.VERTICAL, command=text_output.yview)
scrollbar.grid(row=20, column=180, padx=5)
   
# Associe la barre de défilement à la zone de texte
text_output.config(yscrollcommand=scrollbar.set)

# Liste pour stocker les sélections précédentes
previous_selections = []

# Configuration de la fonction appelée lorsqu'une option est sélectionnée
for i in range (4):
    Liste_var_selected[i].trace("w",on_select)
    

maFenêtre.mainloop()



